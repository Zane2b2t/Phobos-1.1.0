package me.earth.phobos.features.modules.misc;

import me.earth.phobos.features.modules.Module;
import me.earth.phobos.features.setting.Bind;
import me.earth.phobos.features.setting.Setting;
import net.minecraft.client.gui.inventory.GuiContainer;
import net.minecraft.inventory.ClickType;
import net.minecraft.inventory.Slot;
import net.minecraftforge.fml.common.eventhandler.EventPriority;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;
import net.minecraftforge.fml.common.gameevent.InputEvent;
import org.lwjgl.input.Keyboard;

public class Exploits extends Module {

    public Setting<Boolean> illegalCarry = register(new Setting("IllegalCarry", false));
    public Setting<Bind> toXCarry = register(new Setting("ToXCarry", new Bind(-1), v -> illegalCarry.getValue()));
    public Setting<Bind> fromXCarry = register(new Setting("FromXCarry", new Bind(-1), v -> illegalCarry.getValue()));

    public Exploits() {
        super("Exploits", "Some expploits", Category.MISC, true, false, false);
    }

    @SubscribeEvent(priority = EventPriority.NORMAL, receiveCanceled = true)
    public void onKeyInput(InputEvent.KeyInputEvent event) {
        if(Keyboard.getEventKeyState() && mc.currentScreen instanceof GuiContainer) {
            if(toXCarry.getValue().getKey() == Keyboard.getEventKey()) {
                GuiContainer container = (GuiContainer)mc.currentScreen;
                Slot slot = container.getSlotUnderMouse();
                if (slot != null) {
                    mc.playerController.windowClick(container.inventorySlots.windowId, slot.getSlotIndex(), 0, ClickType.PICKUP, mc.player);
                    mc.playerController.windowClick(container.inventorySlots.windowId, -999, 0, ClickType.QUICK_CRAFT, mc.player);
                    mc.playerController.windowClick(0, 1, 1, ClickType.QUICK_CRAFT, mc.player);
                    mc.playerController.windowClick(container.inventorySlots.windowId, -999, 2, ClickType.QUICK_CRAFT, mc.player);
                }
            } else if(fromXCarry.getValue().getKey() == Keyboard.getEventKey()) {
                GuiContainer container = (GuiContainer)mc.currentScreen;
                Slot slot = container.getSlotUnderMouse();
                if (slot != null) {
                    mc.playerController.windowClick(0, 1, 0, ClickType.PICKUP, mc.player);
                    mc.playerController.windowClick(0, -999, 0, ClickType.QUICK_CRAFT, mc.player);
                    mc.playerController.windowClick(container.inventorySlots.windowId, slot.getSlotIndex(), 1, ClickType.QUICK_CRAFT, mc.player);
                    mc.playerController.windowClick(0, -999, 2, ClickType.QUICK_CRAFT, mc.player);
                }
            }
        }
    }
}
